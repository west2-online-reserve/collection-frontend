<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>海绵宝宝抓章鱼</title>
  </head>
  <style>
    * {
      font-size: 30px;
    }
  </style>
  <body>
    <p>
      海绵宝宝很爱抓章鱼，可爱的学长（出题人）把章鱼哥也混在里面了，尽管他也是章鱼，但是不能抓到他。
    </p>
    <p>
      现在我们要将章鱼哥先从这些章鱼中分离出来（即把这个节点从
      <code>&lt;ul&gt;</code> 里面去掉），之后再抓章鱼。
    </p>
    <p>
      海绵宝宝抓章鱼喜欢先从重量小的开始抓，请帮助可爱的海绵宝宝和可爱的学长
    </p>

    <ul id="octopus">
      <li>
        <span class="name">章鱼一号</span><span class="weight">30.4kg</span>
      </li>
      <li>
        <span class="name">章鱼二号</span><span class="weight">24.2kg</span>
      </li>
      <li>
        <span class="name">章鱼三号</span><span class="weight">250.3kg</span>
      </li>
      <li>
        <span class="name">章鱼四号</span><span class="weight">300.9kg</span>
      </li>
      <li>
        <span class="name">章鱼五号</span><span class="weight">120.0kg</span>
      </li>
      <li>
        <span class="name">章鱼六号</span><span class="weight">27.5kg</span>
      </li>
      <li>
        <span class="name">章鱼七号</span><span class="weight">35.4kg</span>
      </li>
      <li>
        <span class="name">章鱼哥</span><span class="weight">25.5kg</span>
      </li>
    </ul>

    <ul id="octopus-sort">
      <!--
        <li>第一只章鱼：章鱼六号：27.5kg</li>
      -->
    </ul>

    <button id="sort-btn">排序</button>

    <!-- 不可以修改上述代码内容，只能在 script 标签内填写代码 -->

    <script>
      /* 把章鱼哥节点从 ul 列表中删除 */
      function remove() {
        // [请在此处填写代码]
        const sourceList = document.getElementById('octopus');
        const targetList = document.getElementById('octopus-sort');
        if (targetList) {
          targetList.innerHTML = '';
        }
        if (!sourceList) {
          return;
        }

        const items = Array.from(sourceList.querySelectorAll('li'));
        const targetItem = items.find((item) => {
          const nameEl = item.querySelector('.name');
          return nameEl ? nameEl.textContent.trim() === '章鱼哥' : false;
        });

        if (targetItem) {
          targetItem.remove();
        }
      }

      /*
       * 读取 id 为 octopus 的列表，获取其中章鱼名字和体重
       * 返回一个 JSON 数组，格式见函数中示例
       */
      function getWeight() {
        /*
          data = [
            {
              "name": "章鱼一号",
              "weight": 30.4
            },
            {
              "name": "章鱼二号",
              "weight": 24.2
            },
          ]
        */
        const list = document.getElementById('octopus');
        if (!list) {
          return [];
        }

        return Array.from(list.querySelectorAll('li'))
          .map((item) => {
            const nameEl = item.querySelector('.name');
            const weightEl = item.querySelector('.weight');
            const name = nameEl ? nameEl.textContent.trim() : '';
            const weightText = weightEl ? weightEl.textContent.trim() : '';
            const weightValue = parseFloat(weightText.replace(/kg/gi, ''));
            return {
              name,
              weight: weightValue,
            };
          })
          .filter((item) => item.name && !Number.isNaN(item.weight));
      }

      /* 按章鱼重量，对 data 进行从小到大的排序，返回排序后的数组 */
      function getSortedOctopus(data) {
        return data.slice().sort((a, b) => a.weight - b.weight);
      }

      /** 将排好序的章鱼朋友输出显示到 id 为 octopus-sort 的列表中，格式见 ul 中注释 */
      function render(data) {
        // [请在此处填写代码]
        const targetList = document.getElementById('octopus-sort');
        if (!targetList) {
          return;
        }

        const numerals = ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十'];
        const fragment = document.createDocumentFragment();

        data.forEach((item, index) => {
          const li = document.createElement('li');
          const order = numerals[index] || `${index + 1}`;
          const weightText = `${item.weight.toFixed(1)}kg`;
          li.textContent = `第${order}只章鱼：${item.name}，${weightText}`;
          fragment.appendChild(li);
        });

        targetList.appendChild(fragment);
      }

      // 按钮点击事件处理函数
      function handleButtonClick() {
        // [请在此处填写代码]
        remove();
        const weightData = getWeight();
        if (!weightData.length) {
          return;
        }
        const sortedData = getSortedOctopus(weightData);
        render(sortedData);
      }

      // 给 sort-btn 绑定一个点击事件，点击时触发 handleButton 函数
      // 触发后在浏览器上可以看到结果
      // [请在此处填写代码]
      const sortButton = document.getElementById('sort-btn');
      if (sortButton) {
        sortButton.addEventListener('click', handleButtonClick);
      }
    </script>
  </body>
</html>
